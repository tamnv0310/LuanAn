var product_dist_data=[];function customRange(t){if("todate"==t.id){var e=new Date($("#fromdate").val());return e.setDate(e.getDate()+1),{minDate:e}}return{}}function formatDateYYYYMMDD(t){var e=t.split("-");return e[2]+"-"+e[1]+"-"+e[0]}var ctx=null,my_chart=null;function initChart(){(ctx=document.getElementById("my_chart").getContext("2d")).fillStyle="white",my_chart=new Chart(ctx,{type:"line",data:{labels:[],datasets:[]},options:{scales:{y:{min:0,max:50,beginAtZero:!0}},responsive:!0,plugins:{export:{enabled:!0}}}})}function triggerDownloadChartImg(){$("#btn-download-chart").click((function(){var t=$("#fromdate").val(),e=$("#todate").val(),a=$("#selectDistrict").find(":selected").val(),o=$("#selectProduct").find(":selected").val(),n=document.createElement("a");n.href=getChartImgBase64(my_chart),n.download=o+"_"+a+"_"+t+"_"+e+".png",console.log(n),n.click()}))}function getChartImgBase64(t){return t.toBase64Image()}function LoadArea(){var t=[{value:"hcm",text:"Thành phố Hồ Chí Minh"},{value:"binhduong",text:"Bình Dương"},{value:"vungtau",text:"Bà Rịa - Vũng Tàu"},{value:"dongnai",text:"Đồng Nai"},{value:"tayninh",text:"Tây Ninh"},{value:"binhphuoc",text:"Bình Phước"}];for(var e in t){var a=new Option(t[e].text,t[e].value);$(a).html(t[e].text),$("#selectLocation").append(a)}}$((function(){$("#exportChartToCSV").hide(),$("#fromdate, #todate").datepicker({showOn:"both",beforeShow:customRange,dateFormat:"dd-mm-yy",regional:"vi"}),$("#fromdate").datepicker("setDate",-7),$("#todate").datepicker("setDate",5),LoadArea(),initChart(),$("#retriveData").click((function(){$("#exportChartToCSV").show();var t=$("#selectLocation").find(":selected").val(),e=formatDateYYYYMMDD($("#fromdate").val()),a=formatDateYYYYMMDD($("#todate").val());if(!t||!e||!a)return void alert("Vui lòng nhập đầy đủ dữ liệu cần truy vấn.");if(e>a)return void alert("Ngày bắt đầu phải bé hơn ngày kết thúc.");console.log(e);var o=[],n=[],r=[];my_chart.data.datasets=[];for(var i=new Date(e),l=new Date(a);i<=l;){var d=i.toLocaleDateString("en-US",{day:"numeric",month:"numeric",year:"numeric"});o.push(d),i.setDate(i.getDate()+1)}let c="/get-temperature/"+t+"/"+e+"/"+a;$.get(c,{}).done((function(t){console.log("Response:",t);if(JSON.parse(t).forEach((t=>{t.isForecast?r.push(t.val):(n.push(t.val),r.push("NaN"))})),r.includes("NaN")&&n.length>0){r.splice(r.indexOf("NaN"),1);let t=r.lastIndexOf("NaN");r.splice(t+1,0,n[n.length-1])}console.log(r),console.log(n),my_chart.data.datasets.push({label:"Giá trị thực tế",data:n,fill:!0,borderColor:"#ff4d4d",backgroundColor:"rgba(0, 0, 0, 0)",tension:.35,borderWidth:2,pointBorderWidth:1.23,pointRadius:1.5}),my_chart.data.datasets.push({label:"Giá trị dự báo",data:r,fill:!0,borderColor:"#95adbe",backgroundColor:"rgba(0, 0, 0, 0)",tension:.35,borderWidth:2,pointBorderWidth:1.23,pointRadius:1.5}),my_chart.data.labels=o,my_chart.options={scales:{yAxes:[{ticks:{Min:0,Max:50}}]},plugins:{legend:{position:"top"},title:{display:!0,text:"Nhiệt độ không khí tầm 2 mét",position:"top",font:{size:15},padding:{top:10,bottom:12}},tooltip:{titleFont:{size:14,lineHeight:1.5},bodyFont:{size:13.2,lineHeight:1.4},padding:10,caretPadding:5,callbacks:{beforeTitle:function(t){return"Nhiệt độ"},title:function(t){return"Ngày: "+t[0].label},label:function(t){return" "+t.dataset.label+": "+t.formattedValue.toLocaleString("vi-VN")+" °C"}}},export:{enabled:!0}}},my_chart.update()})).fail((function(t){console.error("Error in AJAX request: ",t)}))})),$("#exportChartToCSV").click((function(){alert("exportChartToCSV");var t=$("#selectLocation").find(":selected").val(),e=formatDateYYYYMMDD($("#fromdate").val()),a=formatDateYYYYMMDD($("#todate").val());if(!t||!e||!a)return void alert("Vui lòng nhập đầy đủ dữ liệu cần truy vấn.");if(e>a)return void alert("Ngày bắt đầu phải bé hơn ngày kết thúc.");console.log(e);var o=[];my_chart.data.datasets=[];for(var n=new Date(e),r=new Date(a);n<=r;){var i=n.toLocaleDateString("en-US",{day:"numeric",month:"numeric",year:"numeric"});o.push(i),n.setDate(n.getDate()+1)}let l="/export-temperature/"+t+"/"+e+"/"+a;$.get(l,{}).done((function(o){console.log("Response:",o);var n="export_temperature_data_"+t+"_"+e+"_"+a+".csv",r=new Blob([o],{type:"application/octet-stream"}),i=document.createElement("a");i.href=window.URL.createObjectURL(r),i.download=n,i.click(),window.URL.revokeObjectURL(i.href),URL.revokeObjectURL(downloadUrl),xhr.send()})).fail((function(t){console.error("Error in AJAX request: ",t)}))})),triggerDownloadChartImg(),$("[data-toggle='tooltip']").tooltip()}));
//# sourceMappingURL=statistic-dist.js.map