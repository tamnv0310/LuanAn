!function(){function t(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var a,n,o,i,l=[],s=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(a=o.call(r)).done)&&(l.push(a.value),l.length!==e);s=!0);}catch(t){c=!0,n=t}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw n}}return l}}(t,r)||function(t,r){if(!t)return;if("string"==typeof t)return e(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e(t,r)}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}item_list={hcm:[10.7759,106.7013,"Thành phố Hồ Chí Minh","TP.HCM"],binhduong:[11.3254,106.477,"Tỉnh Bình Dương","Bình Dương"],binhphuoc:[11.5473,106.8832,"Tỉnh Bình Phước","Bình Phước"],dongnai:[11.0682,107.1678,"Tỉnh Đồng Nai","Đồng Nai"],tayninh:[11.3352,106.1099,"Tỉnh Tây Ninh","Tây Ninh"],vungtau:[10.508,107.1975,"Tỉnh Bà Rịa - Vũng Tàu","Bà Rịa - Vũng Tàu"]};var r=null,a=[],n=[],o=null,i=null,l=null,s=null;var c=[],u=5,d="10/03/2023",p=new Array(7);p[0]="Chủ nhật",p[1]="Thứ hai",p[2]="Thứ ba",p[3]="Thứ tư",p[4]="Thứ năm",p[5]="Thứ sáu",p[6]="Thứ bảy";var f,h=["#1d10ff","#3f66ff","#b1d2f4","#5dd5d1","#258200","#9fcf00","#f9cf00","#f66401","#f70000"],v={temperature:{id:"temperature",label:"°C",unit:"°C",unitConvert:"°C",threshold:20,max:40}};function g(t){var e=new Date(t),r=""+(e.getMonth()+1),a=""+e.getDate(),n=e.getFullYear();return r.length<2&&(r="0"+r),a.length<2&&(a="0"+a),[a,r,n].join("-")}function m(t,e,r){var a="#a6a6a6";for(var n in r){if(!(t>=e/r.length*n))break;a=r[n]}return a}function y(t){$("#colorLegend ul").find(".value").remove();var e=$("#selectProduct").val(),r=v[e].max,a=v[e].unit;$("#product-unit.unit").html(a);for(var n=t.length-1;n>=0;n--){var o=r/(t.length-1)*n,i=t[n],l='<li class="value" style="background-color: '+i+"; color: "+b(i,!0)+'";>'+T(o,1)+"</li>";$("#colorLegend ul").append(l)}}function b(t,e){if(0===t.indexOf("#")&&(t=t.slice(1)),3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),6!==t.length)throw new Error("Invalid HEX color.");var r=parseInt(t.slice(0,2),16),a=parseInt(t.slice(2,4),16),n=parseInt(t.slice(4,6),16);return e?.299*r+.587*a+.114*n>186?"#000000":"#FFFFFF":(r=(255-r).toString(16),a=(255-a).toString(16),n=(255-n).toString(16),"#"+padZero(r)+padZero(a)+padZero(n))}function T(t,e){var r,a=[{value:1,symbol:""},{value:1e3,symbol:"K"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];for(r=a.length-1;r>0&&!(t>=a[r].value);r--);return(t/a[r].value).toFixed(e).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+a[r].symbol}$((function(){!function(){for(var e in o=L.layerGroup(),item_list){var a=L.divIcon({iconSize:[150,30],iconAnchor:[75,30],html:'<div class="map-label"><div class="map-label-content">'+item_list[e][3]+"</div></div>"});L.marker([item_list[e][0],item_list[e][1]],{icon:a}).addTo(o)}var c='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',u="https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoidGFtdm4xNCIsImEiOiJjbG9vN283eHowMmQ2MmpxaXJ1ZTBtNHdpIn0.fL0XhDxrnTM7OJsAM-sw0A",d=L.tileLayer(u,{id:"mapbox/light-v9",tileSize:512,zoomOffset:-1,attribution:c}),p=L.tileLayer(u,{id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,attribution:c});satellite=L.tileLayer(u,{id:"mapbox/satellite-v9",tileSize:512,zoomOffset:-1,attribution:c}),(l=L.map("map",{center:[10.753286,106.662586],zoom:10,layers:[d]})).attributionControl.setPosition("topright");var f={Grayscale:d,Satellite:satellite,Streets:p},h={"Hiển thị tên địa điểm":o};function v(t,e){e.on({mouseover:g,mouseout:m,click:y})}function g(t){var e=t.target;e.setStyle({weight:3,dashArray:"",opacity:.85,fillOpacity:1}),L.Browser.ie||L.Browser.opera||L.Browser.edge||e.bringToFront(),s.update(e.feature.properties),$(".info.leaflet-control").toggleClass("show",!0)}function m(t){t.target.setStyle({weight:1.25,dashArray:"3",fillOpacity:1,opacity:.6}),s.update(null),$(".info.leaflet-control").toggleClass("show",!1)}function y(t){console.log("Zoom to: ",t.target.getBounds()),l.fitBounds(t.target.getBounds(),{padding:[20,10]})}L.control.layers(f,h).addTo(l),(s=L.control()).onAdd=function(t){return this._div=L.DomUtil.create("div","info"),this.update(),this._div},s.update=function(t){var e=t&&t.name?item_list[t.name][2]:"";this._div.innerHTML="<h4>Tỉnh/Thành Phố</h4>"+(t?"<p><b>"+e+"</b></p><p><b>"+t.product+"</b><br/>"+t.textType+'<b><span class="circle color" style="background-color: '+t.color+'"></span><span> '+t.density+"</span></b> "+t.unit+'</p><p style="text-align: right; margin-bottom: 0;"><i><small>'+t.date+"</small></i></p>":"")},s.addTo(l),$.getJSON("static/data/hcm-district/district_define.json",(function(t){r=t})),$.getJSON("static/data/hcm-district/district_geo.json",(function(e){var a=e.features;for(var o in a){var s=a[o].properties.AdminID;r[s].geometry=a[o].geometry}console.log("District list define: ",r);for(var c=0,u=Object.entries(r);c<u.length;c++){var d=t(u[c],2),p=(d[0],d[1]),f={type:"Feature",properties:{name:p.distId,date:"...",textType:"...",density:"...",unit:"℃",product:"...",color:"#fff",style:{weight:2.5,dashArray:"3",color:"#a6a6a6",opacity:.6,fillColor:"#a6a6a6",fillOpacity:1},show_on_map:!0},geometry:{type:"MultiPolygon",coordinates:[p.geometry.coordinates]}};n.push(f)}i=L.geoJSON(n,{filter:function(t,e){return t.properties.show_on_map},style:function(t){return t.properties.style},onEachFeature:v}).bindPopup((function(t){return t.feature.properties.popupContent})).addTo(l)}))}(),$.get("/get-district-all",{}).done((function(t){for(var e in c=JSON.parse(t)){var r=new Option(c[e].dist_name,c[e]._id);$(r).html(c[e].dist_name),$("#selectDistrict").append(r)}})),$("#selectDistrict").on("change",(function(t){console.log("Zoom to district",t,$(this).val());var e=$(this).val();for(var r in i._layers)if(i._layers[r].feature.properties.name==e){var a=i._layers[r]._bounds;l.fitBounds(a,{padding:[20,10]})}})),function(){for(var t in v){var e=new Option(v[t].label,v[t].id);$(e).html(v[t].label),$("#selectProduct").append(e)}}(),$("#selectProduct").on("change",(function(t){console.log("Change product",t,$(this).val()),i.resetStyle(),y(h),$("a.date.current").click()})),y(h),$(document).on("click","a.date",{param:1},(function(t){t.preventDefault(),console.log("On click button!!!!!!");var e=$(this);$("a.date").removeClass("selected"),e.addClass("selected");var r,n,o,l,s,c=parseInt(e.attr("data-index"))-1,u=e.attr("data-value");$("#date").datepicker("setDate",u),f.slideTo(c),r=e.attr("data-value"),n=$("#selectProduct").val(),o=e.hasClass("forecast"),l=o?"get-product-forecast":"get-product",s=r.split("-").reverse().join("-"),$.get(l+"/all-dist/"+n+"/"+s,{}).done((function(t){console.log("Data on ",r,JSON.parse(t));var e=JSON.parse(t),n=e.product_id,l=v[n].max,s=e.query_date,c=setInterval((function(){if(i){for(var t in a){var r=a[t].properties.name,u=parseFloat(e.data[r]).toFixed(2),d=Number(u).toLocaleString("vi-VN");console.log("density_val: ",d),a[t].properties.textType=o?"<b>Dự báo: </b>":"<b>Sentinel-5P: </b>",a[t].properties.density=d,a[t].properties.color=m(u,l,h),a[t].properties.product=v[n].label,a[t].properties.unit=v[n].unit,a[t].properties.date=p[new Date(s).getDay()]+", "+g(s)}i.setStyle((function(t){var r=t.properties.name;return{fillColor:m(e.data[r],l,h),color:"#ffffff"}})),clearInterval(c)}}),250)}))})),function(){var t,e=1;$(".control-date ul li a").click((function(r){r.preventDefault();var a=$(this).attr("data-type");switch(console.log("type = ",a),a){case"prev":console.log("Click previous!");var n=$("a.date.selected").prev();n.length&&n.trigger("click");break;case"next":console.log("Click next!");var o=$("a.date.selected").next();o.length&&o.trigger("click");break;default:$(this).hasClass("readyToStop")?(e=-1,$(this).removeClass("readyToStop")):(e=1,$(this).addClass("readyToStop")),e?t=setInterval((function(){if(1==e){var r=$("a.date.selected").next();r.length&&r.trigger("click")}else clearInterval(t)}),2e3):clearInterval(t)}}))}(),function(){$("#date").datepicker({showOn:"both",dateFormat:"dd-mm-yy",regional:"vi"}).on("change",(function(){var t=$(this).val();$("a.date[data-value="+t+"]").click()})),$("#date").datepicker("setDate",new Date);var t=new Date;t.setDate(t.getDate()+u),$("#date").datepicker("option","minDate",new Date(d)),$("#date").datepicker("option","maxDate",t)}()}))}();
//# sourceMappingURL=main-dist.js.map