!function(){function e(e,a){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,o,i,l=[],s=!0,c=!1;try{if(o=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;s=!1}else for(;!(s=(n=o.call(a)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,r=e}finally{try{if(!s&&null!=a.return&&(i=a.return(),Object(i)!==i))return}finally{if(c)throw r}}return l}}(e,a)||function(e,a){if(!e)return;if("string"==typeof e)return t(e,a);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,a)}(e,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}item_list={hcm:[10.7759,106.7013,"Thành phố Hồ Chí Minh","TP.HCM"],binhduong:[11.1712,106.6327,"Tỉnh Bình Dương","Bình Dương"],binhphuoc:[11.7494,106.9158,"Tỉnh Bình Phước","Bình Phước"],dongnai:[11.0682,107.1678,"Tỉnh Đồng Nai","Đồng Nai"],tayninh:[11.3352,106.1099,"Tỉnh Tây Ninh","Tây Ninh"],vungtau:[10.5111,107.2563,"Tỉnh Bà Rịa - Vũng Tàu","Bà Rịa - Vũng Tàu"]};var a=null,n=[],r=null,o=null,i=null,l=null;var s=[],c=5,u="01/10/1981",d="10/03/2023",p=new Array(7);p[0]="Chủ nhật",p[1]="Thứ hai",p[2]="Thứ ba",p[3]="Thứ tư",p[4]="Thứ năm",p[5]="Thứ sáu",p[6]="Thứ bảy";var f,h=["#1d10ff","#3f66ff","#b1d2f4","#5dd5d1","#258200","#9fcf00","#f9cf00","#f66401","#f70000","#660000"],g={temperature:{id:"temperature",label:"°C",unit:"°C",unitConvert:"°C",threshold:20,max:45}};function v(e){var t=new Date(e),a=""+(t.getMonth()+1),n=""+t.getDate(),r=t.getFullYear();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[n,a,r].join("-")}function m(e,t,a){var n="#a6a6a6";for(var r in a){if(!(e>=t/a.length*r))break;n=a[r]}return n}function y(e){$("#colorLegend ul").find(".value").remove();var t=$("#selectProduct").val(),a=g[t].max,n=g[t].unit;$("#product-unit.unit").html(n);for(var r=e.length-1;r>=0;r--){var o=a/(e.length-1)*r,i=e[r],l=e.length-1===r?"+":"",s='<li class="value" style="background-color: '+i+"; color: "+b(i,!0)+'";>'+w(o,1)+l+"</li>";$("#colorLegend ul").append(s)}}function b(e,t){if(0===e.indexOf("#")&&(e=e.slice(1)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),6!==e.length)throw new Error("Invalid HEX color.");var a=parseInt(e.slice(0,2),16),n=parseInt(e.slice(2,4),16),r=parseInt(e.slice(4,6),16);return t?.299*a+.587*n+.114*r>186?"#000000":"#FFFFFF":(a=(255-a).toString(16),n=(255-n).toString(16),r=(255-r).toString(16),"#"+padZero(a)+padZero(n)+padZero(r))}function w(e,t){var a,n=[{value:1,symbol:""},{value:1e3,symbol:"K"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];for(a=n.length-1;a>0&&!(e>=n[a].value);a--);return(e/n[a].value).toFixed(t).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n[a].symbol}$((function(){!function(){for(var t in r=L.layerGroup(),item_list){var s=L.divIcon({iconSize:[150,30],iconAnchor:[75,30],html:'<div class="map-label"><div class="map-label-content">'+item_list[t][3]+"</div></div>"});L.marker([item_list[t][0],item_list[t][1]],{icon:s}).addTo(r)}var c='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',u="https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoidGFtdm4xNCIsImEiOiJjbG9vN283eHowMmQ2MmpxaXJ1ZTBtNHdpIn0.fL0XhDxrnTM7OJsAM-sw0A",d=L.tileLayer(u,{id:"mapbox/light-v9",tileSize:512,zoomOffset:-1,attribution:c}),p=L.tileLayer(u,{id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,attribution:c});satellite=L.tileLayer(u,{id:"mapbox/satellite-v9",tileSize:512,zoomOffset:-1,attribution:c}),(i=L.map("map",{center:[11.10165037285805,106.76075056221242],zoom:9,layers:[d]})).attributionControl.setPosition("topright");var f={Grayscale:d,Satellite:satellite,Streets:p},h={"Hiển thị tên địa điểm":r};function g(e,t){t.on({mouseover:v,mouseout:m,click:y})}function v(e){var t=e.target;t.setStyle({weight:3,dashArray:"",opacity:.85,fillOpacity:1}),L.Browser.ie||L.Browser.opera||L.Browser.edge||t.bringToFront(),l.update(t.feature.properties),$(".info.leaflet-control").toggleClass("show",!0)}function m(e){e.target.setStyle({weight:1.25,dashArray:"3",fillOpacity:1,opacity:.6}),l.update(null),$(".info.leaflet-control").toggleClass("show",!1)}function y(e){console.log("Zoom to: ",e.target.getBounds()),i.fitBounds(e.target.getBounds(),{padding:[20,10]})}L.control.layers(f,h).addTo(i),(l=L.control()).onAdd=function(e){return this._div=L.DomUtil.create("div","info"),this.update(),this._div},l.update=function(e){var t=e&&e.name?item_list[e.name][2]:"";this._div.innerHTML="<h4>Địa điểm</h4>"+(e?"<p><b>"+t+"</b></p><p>"+e.textType+'<b><span class="circle color" style="background-color: '+e.color+'"></span><span> '+e.density+"</span></b> "+e.unit+'</p><p style="text-align: right; margin-bottom: 0;"><i><small>Thứ hai, 2/10/2023</small></i></p>':"")},l.addTo(i),$.getJSON("static/data/province/province_define.json",(function(e){a=e})),$.getJSON("static/data/province/province_geo.json",(function(t){var r=t.features;for(var l in r){var s=r[l].properties.AdminID;a[s].geometry=r[l].geometry}console.log("District list define: ",a);for(var c=0,u=Object.entries(a);c<u.length;c++){var d=e(u[c],2),p=(d[0],d[1]),f={type:"Feature",properties:{name:p.distId,date:"...",textType:"...",density:"...",unit:"℃",product:"...",color:"#fff",style:{weight:2.5,dashArray:"3",color:"#777777",opacity:.6,fillColor:"#a6a6a6",fillOpacity:1},show_on_map:!0},geometry:{type:"MultiPolygon",coordinates:[p.geometry.coordinates]}};n.push(f)}o=L.geoJSON(n,{filter:function(e,t){return e.properties.show_on_map},style:function(e){return e.properties.style},onEachFeature:g}).bindPopup((function(e){return e.feature.properties.popupContent})).addTo(i)}))}(),$.get("/get-district-all",{}).done((function(e){for(var t in s=JSON.parse(e)){var a=new Option(s[t].dist_name,s[t]._id);$(a).html(s[t].dist_name),$("#selectDistrict").append(a)}})),$("#selectDistrict").on("change",(function(e){console.log("Zoom to district",e,$(this).val());var t=$(this).val();for(var a in o._layers)if(o._layers[a].feature.properties.name==t){var n=o._layers[a]._bounds;i.fitBounds(n,{padding:[20,10]})}})),function(){for(var e in g){var t=new Option(g[e].label,g[e].id);$(t).html(g[e].label),$("#selectProduct").append(t)}}(),$("#selectProduct").on("change",(function(e){console.log("Change product",e,$(this).val()),o.resetStyle(),y(h),$("a.date.current").click()})),y(h),$(document).on("click","a.date",{param:1},(function(e){e.preventDefault(),console.log("On click button!!!!!!");var t=$(this);$("a.date").removeClass("selected"),t.addClass("selected");var a=parseInt(t.attr("data-index"))-1,r=t.attr("data-value");$("#date").datepicker("setDate",r),f.slideTo(a),function(e,t,a){var r={product_id:"temperature",query_date:"2023-11-12",data:{vungtau:29,dongnai:31,binhphuoc:32,tayninh:32,hcm:32,binhduong:32}};console.log("Data on ",e,r);var i=50,l=r.query_date,s=setInterval((function(){if(o){for(var e in n){var t=n[e].properties.name,c=parseFloat(r.data[t]).toFixed(2),u=Number(c).toLocaleString("vi-VN");console.log("density_val: ",u),n[e].properties.textType=a?"<b>Dự báo: </b>":"<b>POWER NASA: </b>",n[e].properties.density=u,n[e].properties.color=m(c,i,h),n[e].properties.date=p[new Date(l).getDay()]+", "+v(l)}o.setStyle((function(e){var t=e.properties.name;return{fillColor:m(r.data[t],i,h),color:"#ffffff"}})),clearInterval(s)}}),250)}(t.attr("data-value"),$("#selectProduct").val(),t.hasClass("forecast"))})),function(){var e,t=1;$(".control-date ul li a").click((function(a){a.preventDefault();var n=$(this).attr("data-type");switch(console.log("type = ",n),n){case"prev":console.log("Click previous!");var r=$("a.date.selected").prev();r.length&&r.trigger("click");break;case"next":console.log("Click next!");var o=$("a.date.selected").next();o.length&&o.trigger("click");break;default:$(this).hasClass("readyToStop")?(t=-1,$(this).removeClass("readyToStop")):(t=1,$(this).addClass("readyToStop")),t?e=setInterval((function(){if(1==t){var a=$("a.date.selected").next();a.length&&a.trigger("click")}else clearInterval(e)}),2e3):clearInterval(e)}}))}(),function(){$("#date").datepicker({showOn:"both",dateFormat:"dd-mm-yy",regional:"vi"}).on("change",(function(){var e=$(this).val();$("a.date[data-value="+e+"]").click()})),$("#date").datepicker("setDate",new Date(d));var e=new Date;e.setDate(e.getDate()+c),$("#date").datepicker("option","minDate",new Date(u)),$("#date").datepicker("option","maxDate",e)}(),f=new Swiper(".dateSwiper",{slidesPerView:"auto",spaceBetween:15,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},on:{init:function(){console.log("swiper initialized")},afterInit:function(){console.log("after initialized",f);var e=function(){for(var e=new Date(d),t=new Date(2022,10,10),a=Math.abs(e-t),n=Math.ceil(a/864e5)-1,r=[],o=n+1;o>0;o--){var i=new Date(d);i.setDate(i.getDate()-o),r.push({date:v(i),wkday:p[i.getDay()],class:0==o?"forecast":"actual"})}for(o=0;o<c+1;o++){var l=new Date(d);l.setDate(l.getDate()+o),r.push({date:v(l),wkday:p[l.getDay()],class:0==o?"forecast current":"forecast"})}return r}();if(console.log("Date range",e),e.length){for(var t=[],a=e.length-1;a>0;a--)element='<a class="swiper-slide date '+e[a].class+'" data-value="'+e[a].date+'" data-index="'+a+'"><h4>'+e[a].wkday+"</h4><label>"+e[a].date+"</label></a>",t.push(element);setTimeout((function(){f.prependSlide(t)}),1500),setTimeout((function(){$("a.date.current").trigger("click")}),1500)}},slidesLengthChange:function(){$("a.date.current").trigger("click")}}})}))}();
//# sourceMappingURL=main-dist.js.map